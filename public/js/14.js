(window.webpackJsonp=window.webpackJsonp||[]).push([[14,16,59,60,61,129],{0:function(t,e,s){"use strict";function n(t,e,s,n,a,o,i,r){var c,l="function"==typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=s,l._compiled=!0),n&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),i?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),a&&a.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(i)},l._ssrRegister=c):a&&(c=r?function(){a.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:a),c)if(l.functional){l._injectStyles=c;var d=l.render;l.render=function(t,e){return c.call(e),d(t,e)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,c):[c]}return{exports:t,options:l}}s.d(e,"a",(function(){return n}))},108:function(t,e,s){var n=s(321);"string"==typeof n&&(n=[[t.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};s(12)(n,a);n.locals&&(t.exports=n.locals)},109:function(t,e,s){var n=s(323);"string"==typeof n&&(n=[[t.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};s(12)(n,a);n.locals&&(t.exports=n.locals)},112:function(t,e,s){var n=s(329);"string"==typeof n&&(n=[[t.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};s(12)(n,a);n.locals&&(t.exports=n.locals)},113:function(t,e,s){var n=s(331);"string"==typeof n&&(n=[[t.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};s(12)(n,a);n.locals&&(t.exports=n.locals)},253:function(t,e,s){var n=s(348);"string"==typeof n&&(n=[[t.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};s(12)(n,a);n.locals&&(t.exports=n.locals)},297:function(t,e,s){"use strict";s.r(e);var n=s(4),a=s(87),o=s(86),i={layout:n.default,props:{user:{type:Object,required:!0}},data:function(){return{selectedContact:null,messages:[],contacts:[]}},mounted:function(){var t=this;Echo.private("messages.".concat(this.user.id)).listen("NewMessage",(function(e){t.hanleIncoming(e.message)})),axios.get("/contacts").then((function(e){t.contacts=e.data}))},methods:{startConversationWith:function(t){var e=this;this.updateUnreadCount(t,!0),axios.get("/conversation/".concat(t.id)).then((function(s){e.messages=s.data,e.selectedContact=t}))},saveNewMessage:function(t){this.messages.push(t)},hanleIncoming:function(t){this.selectedContact&&t.from==this.selectedContact.id?this.saveNewMessage(t):this.updateUnreadCount(t.from_contact,!1)},updateUnreadCount:function(t,e){this.contacts=this.contacts.map((function(s){return s.id!==t.id||(e?s.unread=0:s.unread+=1),s}))}},components:{Conversation:a.default,ContactsList:o.default}},r=(s(347),s(0)),c=Object(r.a)(i,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"chat-app"},[e("ContactsList",{attrs:{contacts:this.contacts},on:{selected:this.startConversationWith}}),this._v(" "),e("Conversation",{attrs:{contact:this.selectedContact,messages:this.messages},on:{new:this.saveNewMessage}})],1)}),[],!1,null,"726eb531",null);e.default=c.exports},320:function(t,e,s){"use strict";s(108)},321:function(t,e,s){(t.exports=s(11)(!1)).push([t.i,".feed[data-v-071c4446]{background:#f0f0f0;height:100%;max-height:470px;overflow:scroll;ul{list-style-type:none;padding:5px;li{&.message{margin:10px 0;width:100%;.text{max-width:200px;border-radius:5px;padding:12px;display:inline-block}&.received{text-align:right;.text{background:#fff}}&.sent{text-align:left;.text{background:#90e0b2}}}}}}",""])},322:function(t,e,s){"use strict";s(109)},323:function(t,e,s){(t.exports=s(11)(!1)).push([t.i,".composer textarea[data-v-15ad932b]{width:96%;margin:10px;resize:none;border-radius:3px;border:1px solid #d3d3d3;padding:6px}",""])},328:function(t,e,s){"use strict";s(112)},329:function(t,e,s){(t.exports=s(11)(!1)).push([t.i,".contacts-list[data-v-a600736a]{flex:2;max-height:100%;height:600px;overflow:scroll;border-left:1px solid #a6a6a6;ul{list-style-type:none;padding-left:0;li{display:flex;padding:2px;border-bottom:1px solid #aaa;height:80px;position:relative;cursor:pointer;&.selected{background:#81c4f9}span.unread{background:#82e0a8;color:#fff;position:absolute;right:11px;top:20px;font-weight:700;min-width:20px;justify-content:center;line-height:20px;font-size:12px;padding:0 4px;border-radius:3px}.avatar,span.unread{display:flex;align-items:center}.avatar{flex:1;img{width:35px;border-radius:50%;margin:0 auto}}.contact{flex:3;font-size:10px;overflow:hidden;display:flex;flex-direction:column;justify-content:center;p{margin:0;&.name{font-weight:700}}}}}}",""])},330:function(t,e,s){"use strict";s(113)},331:function(t,e,s){(t.exports=s(11)(!1)).push([t.i,".conversation[data-v-afc8cc64]{flex:5;display:flex;flex-direction:column;justify-content:space-between;h1{font-size:20px;padding:10px;margin:0;border-bottom:1px dashed #d3d3d3}}",""])},347:function(t,e,s){"use strict";s(253)},348:function(t,e,s){(t.exports=s(11)(!1)).push([t.i,".chat-app[data-v-726eb531]{display:flex}",""])},53:function(t,e,s){"use strict";s.r(e);var n={props:{contact:{type:Object},messages:{type:Array,required:!0}},methods:{scrollToBottom:function(){var t=this;setTimeout((function(){t.$refs.feed.scrollTop=t.$refs.feed.scrollHeight-t.$refs.feed.clientHeight}),50)}},watch:{contact:function(t){this.scrollToBottom()},messages:function(t){this.scrollToBottom()}}},a=(s(320),s(0)),o=Object(a.a)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"feed",staticClass:"feed"},[t.contact?s("ul",t._l(t.messages,(function(e){return s("li",{key:e.id,class:"message"+(e.to==t.contact.id?" sent":" received")},[s("div",{staticClass:"text"},[t._v("\n                "+t._s(e.text)+"\n            ")])])})),0):t._e()])}),[],!1,null,"071c4446",null);e.default=o.exports},54:function(t,e,s){"use strict";s.r(e);var n={data:function(){return{message:""}},methods:{send:function(t){t.preventDefault(),""!=this.message&&(this.$emit("send",this.message),this.message="")}}},a=(s(322),s(0)),o=Object(a.a)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"composer"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],attrs:{placeholder:"Message..."},domProps:{value:t.message},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.send(e)},input:function(e){e.target.composing||(t.message=e.target.value)}}})])}),[],!1,null,"15ad932b",null);e.default=o.exports},86:function(t,e,s){"use strict";s.r(e);var n={props:{contacts:{type:Array,default:[]}},data:function(){return{selected:this.contacts.length?this.contacts[0]:null}},methods:{selectContact:function(t){this.selected=t,this.$emit("selected",t)}},computed:{sortedContacts:function(){var t=this;return _.sortBy(this.contacts,[function(e){return e==t.selected?1/0:e.unread}]).reverse()}}},a=(s(328),s(0)),o=Object(a.a)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"contacts-list"},[s("ul",t._l(t.sortedContacts,(function(e){return s("li",{key:e.id,class:{selected:e==t.selected},on:{click:function(s){return t.selectContact(e)}}},[s("div",{staticClass:"avatar"},[s("img",{attrs:{src:e.profile_image,alt:e.name}})]),t._v(" "),s("div",{staticClass:"contact"},[s("p",{staticClass:"name"},[t._v(t._s(e.name))]),t._v(" "),s("p",{staticClass:"email"},[t._v(t._s(e.email))])]),t._v(" "),e.unread?s("span",{staticClass:"unread"},[t._v(t._s(e.unread))]):t._e()])})),0)])}),[],!1,null,"a600736a",null);e.default=o.exports},87:function(t,e,s){"use strict";s.r(e);var n=s(53),a=s(54),o={props:{contact:{type:Object,default:null},messages:{type:Array,default:[]}},methods:{sendMessage:function(t){var e=this;this.contact&&axios.post("/conversation/send",{contact_id:this.contact.id,text:t}).then((function(t){e.$emit("new",t.data)}))}},components:{MessagesFeed:n.default,MessageComposer:a.default}},i=(s(330),s(0)),r=Object(i.a)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"conversation"},[s("h1",[t._v(t._s(t.contact?t.contact.name:"Start Covesation by selecting contact"))]),t._v(" "),s("MessagesFeed",{attrs:{contact:t.contact,messages:t.messages}}),t._v(" "),t.contact?s("MessageComposer",{on:{send:t.sendMessage}}):t._e()],1)}),[],!1,null,"afc8cc64",null);e.default=r.exports}}]);